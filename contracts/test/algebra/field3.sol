// SPDX-License-Identifier: MIT OR Apache-2.0
//---------------------------------------------------------------------------//
// Copyright (c) 2023 Vasiliy Olekhov <vasiliy.olekhov@nil.foundation>
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//---------------------------------------------------------------------------//
pragma solidity ^0.8.0;

import '../../../contracts/algebra/field3.sol';
import '../../../contracts/algebra/bls12381.sol';
import 'hardhat/console.sol';

contract test_field3 {

    uint256 constant neg0 = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

    function test_add() public pure {
        uint256[3] memory a = [uint256(1),0,0];
        uint256[3] memory b = [neg0, neg0, neg0];
        (b[0], b[1], b[2]) = field3.add(a[0], a[1], a[2], b[0], b[1], b[2]);
        require(b[0] == 0 && b[1] == 0 && b[2] == 0, "-1+1 = 0 failed");
    }

    function test_sub() public pure {
        uint256[3] memory a = [uint256(0),0,0];
        uint256[3] memory b = [uint256(1),0,0];
        (b[0], b[1], b[2]) = field3.sub(a[0], a[1], a[2], b[0], b[1], b[2]);
        require(b[0] == neg0 && b[1] == neg0 && b[2] == neg0, "0-1 = -1 failed");
    }

    function test_mul() public view 
    {
        uint256[3] memory a = [uint256(1),0,0];
        uint256[3] memory b = [uint256(0x12345678),0,0];
        uint256 gas = gasleft();
        require(
             (a[0] == 0x0000000000000000000000000000000000000000000000000000000000000001) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 1');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        console.log(a[0], a[1], a[2]);
        require(
             (a[0] == 0x0000000000000000000000000000000000000000000000000000000012345678) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 2');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x000000000000000000000000000000000000000000000000014b66dc1df4d840) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 3');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x0000000000000000000000000000000000000000001790fc4eb7762eb86ade00) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 4');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x000000000000000000000000000000000001ad0326899c49d228112b70ac1000) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 5');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x00000000000000000000000000001e81ee41a95d3ac7908c834ba049de078000) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 6');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x00000000000000000000022b5f72f630b2beae25d5e0f29ab3e993bc98840000) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 7');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x00000000000000277e410f0ecb0d79d9e09b9a55fb04a8ca1226de73d5e00000) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 8');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x00000002cef38f3322d63873c74ce00af3e68b71b9356c5ae58461a581000000) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 9');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x33201c61831c7127e6e93e9786ac73b41908f1ff2a0b4177878b92ea78000000) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 10');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x5f9cb17ccdafc00df69bb96f3a0c73a9d6467c9f3114303ec0d8023840000000) &&
             (a[1] == 0x0000000000000000000000000000000000000000000000000000000003a2b5c9) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 11');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x48e342cd7313c20f65f6f44cd441c0aca0b14899fffa0e3b5decefde00000000) &&
             (a[1] == 0x00000000000000000000000000000000000000000000000000422f0f72f74cd2) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 12');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x86cb189f14c036cfc85c1038dbe96a0474c557f90ea85a5ff4bd041000000000) &&
             (a[1] == 0x00000000000000000000000000000000000000000004b4d7000dfd7f5b916fea) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 13');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x993eb6700aceaa8c239dc9655824c99669adb83887f999e02b37478000000000) &&
             (a[1] == 0x00000000000000000000000000000000000055ad70a1fd772c066fdf00e2e833) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 14');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0xd633e21efd2359ddbc66f0c332f2b43f4a5c83b29b4419da59ee840000000000) &&
             (a[1] == 0x00000000000000000000000000000617b616b1dd14623dd333f57d3f6f9fb73b) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 15');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0xf2604f10610c1f11865dd8967a675cb33ece0f884348824b1825e00000000000) &&
             (a[1] == 0x00000000000000000000006ee9ad6766a6bab0c7f75fbf20b9e1ec8f67a32671) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 16');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x2ddb20ed1b2057a515ec352b886aea116637d25da4b5dec18b01000000000000) &&
             (a[1] == 0x0000000000000007e31b1efc0297f27ad6e905b93ece3a4f29c995e135944df5) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 17');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x77d8defcfdad9a777d04c668a178409ffb704fd5292bbd9f7e78000000000000) &&
             (a[1] == 0x000000008f94b3ad947e64ea26bef78335322bec214696a1965b392c02bba128) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 18');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x1dcb3fef025446eddd7f6842764101e2cba877f7b97e979f9840000000000000) &&
             (a[1] == 0x0a35cf55f5c39605076f42f7d10e6ea75093a2cb4515d8cdd51954fde4bcbaf6) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 19');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x0976a8ec89391b1e7a8fca37997e4961d8a208cf7f661cf4de00000000000000) &&
             (a[1] == 0x059dbd21bb9f5829e3b01f1b1596d2eeba0a2a2c3bddd7318414dd55e75ca928) &&
             (a[2] == 0x0000000000000000000000000000000000000000000000000000000000b9def5), 'fails at 20');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x3e10887b28aff4e2bd6b867028f4aa2c5c04e4d71ef0ed5c1000000000000000) &&
             (a[1] == 0x69854d6854d408161e06ab6a6b21936e4c206309c79fcd61ebda1eb4c10f01ed) &&
             (a[2] == 0x000000000000000000000000000000000000000000000000000d37ad4c310e14), 'fails at 21');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x0779fc5bde1eff361b3a37ff1355b4ca630ac2dc207f70878000000000000000) &&
             (a[1] == 0x4da5790a30b5c9dc9ddc390f3305e6d15e797e8bdc606998c6d962c49c3c5f03) &&
             (a[2] == 0x00000000000000000000000000000000000000000000f09df5753dc87d4a4389), 'fails at 22');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x343c73ec2d2b6e45a145e42ecefb9c071980d9e66e1044840000000000000000) &&
             (a[1] == 0x49b8d6426af04930a312a1b1817a4374a35dd899e1ae7f8420005397075ba674) &&
             (a[2] == 0x000000000000000000000000000000000000111c4c9df4a9173efbe70cd93091), 'fails at 23');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0xf26de8750ee2c10eb77a6b8dbd97c363b4250d1c417475e00000000000000000) &&
             (a[1] == 0xd7a15d03229114bc06365247ab2695d8ebe1565b99b8aea0b56ddb963827ec72) &&
             (a[2] == 0x000000000000000000000000000001377cea324a9036a39377fb942710d18b7a), 'fails at 24');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x026f4181670950f6f1a336b28db247b38a1d1f2d7fb081000000000000000000) &&
             (a[1] == 0x65f3e0025f99f70ae9b21f76e112dec4400d765edea26c091db99c03d88a6bfe) &&
             (a[2] == 0x00000000000000000000001626770d14aff5c1ff8cf446f398d0b8553f31cb56), 'fails at 25');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0xebafc2db3cb777edc31cf08d7fd606aa0e583f255a1278000000000000000000) &&
             (a[1] == 0x62c60bdf7bcf76042209bad4e40c4e9142ffffd9825ecaee3f6c2441ccee4516) &&
             (a[2] == 0x0000000000000001933baa6822c61a5e6a3097bfac90cee12f856199ba5e3209), 'fails at 26');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x84a638dd2c4dc1c9fe1b4f37221d5ee5d27fbdf4ccf840000000000000000000) &&
             (a[1] == 0xf4ec60c9fe204e7c249a486d34613c96ab4c2546ed75a5800ca57af1c0205152) &&
             (a[2] == 0x000000001caca24cfecfda96d85d107866d2c1c76475a779b7a3df51d3d098a4), 'fails at 27');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x1f0f6bfa74723b2a4102a5f14b216dbf61d45e8879de00000000000000000000) &&
             (a[1] == 0x14371e22a54cc6eb60841ccc1e952a426f51ce8d73a4cc877d7c24253c8e7901) &&
             (a[2] == 0x020a0029d100514846b7a1747ed7df6a61747ee3310c37bc3f59dc9df7c9566c), 'fails at 28');
        (a[0],a[1],a[2]) = field3.mul3x3(a[0],a[1],a[2], b[0],b[1],b[2]);
        require(
             (a[0] == 0x48906fe1f29351da094874da324a8a5bff988601b41000000000000000000000) &&
             (a[1] == 0x8c9ebd5a3b69359dd336c539b3707dad90996b02a44d9b6c7c27c53ee7d87daf) &&
             (a[2] == 0x49ee9997ab1ba849d2e5c2c6d6b4733090d49f5fa7248d49cdbef842f0c8ccc4), 'fails at 29');        
        gas = gas-gasleft();
        console.log("mul test passed, gas consumed:", gas, " per test: ", gas/28);
    }
    

    function test_divrem() public view 
    {
        uint256 x = 0x6cd4f254f107fac863848ce8b56db5a13f66ce14a2632dbb0b3aa41dd9319ce1;
        uint256 y = 0x0a35cf0f4a940d8fc49e4b88fd39ff84f54ef7f887c63173fde3d95c939bb9e9;
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0xf0602e9c05a41bf8ad732463b9cab2d82291ba58b16c61f40fabf3b0d31e3b42) &&
             (y == 0x000000008f94afcbcd31d4fa0d199883d859299e689c60d96e844ea74db8bd33), 'fails at 1');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x8d2ded57144ef0d63bf2c87604b2d7a58ca29bfe91877a731403b24a46817e5d) &&
             (y == 0x0000000000000007e31ae864fff17a56d7bc80a03c281e959e6c15e964bb4c50), 'fails at 2');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x6a6c3d6f49ede3ca81fc2afdfbe5906a7f32441142d9f43e96bdc6064ac10e69) &&
             (y == 0x00000000000000000000006ee9aa67bb115c3a1b4d5abeb55f77831daf47ce9e), 'fails at 3');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x1b4d4baea0a32339550bfeb716d011a7e834d4ecd273ef0fb8f26ab5cbd93bc1) &&
             (y == 0x00000000000000000000000000000617b5ec86802e7b68617ae51113231bb4f4), 'fails at 4');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0xc60031d6d2f09fe9b3f36e98b58dda00b803b54f4d867764627548a25db5e600) &&
             (y == 0x00000000000000000000000000000000000055ad6e50fbacb757c716e69f5c5f), 'fails at 5');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x98bf9bc962bf690cbdb2c5b2befed3b2d090d11a088317087a8d32bbba417ca6) &&
             (y == 0x00000000000000000000000000000000000000000004b4d6df7ad44f3dd66c53), 'fails at 6');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x71170c92554a699bd19c36efa151cf167916e1419a36f72bb686a8dacada34b3) &&
             (y == 0x00000000000000000000000000000000000000000000000000422f0da8e1d98e), 'fails at 7');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x35cf0bbcdfb4048f3ce093e0b919ad7ff1e8b2eb8f0bb07cc8884ffb5f4c4e5d) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000003a2b5b0), 'fails at 8');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x33201affa7407a8d177791cd8f8e76db6f340a206b12aa2419b3080d9e6ea932) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 9');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x00000002cef37bc2ff105759920c58d40c2c5a783344cf65957f5b7b20202ad6) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 10');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x00000000000000277e3ffdb5d3f5b8e51f7644c1769d00a6c12e2a0df0575be9) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 11');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x00000000000000000000022b5f63f23d9f810321d637c18030d9c5ea9bd441ae) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 12');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x00000000000000000000000000001e81ed6e81d2f5318b8cf8953348efeaa31f) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 13');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x000000000000000000000000000000000001ad031af04040fd02dc96ce4a7433) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 14');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x0000000000000000000000000000000000000000001790fbab9ad7ed189c6968) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 15');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x000000000000000000000000000000000000000000000000014b66d328326678) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 16');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x00000000000000000000000000000000000000000000000000000000123455fa) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 17');
        (x,y) = field3.div512(x,y,0x12345678);
        require(
             (x == 0x0000000000000000000000000000000000000000000000000000000000000000) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 18');    
    }

    function test_mulmod_p381() public pure {
        uint256 x = 0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1;
        uint256 y = 0x0000000000000000000000000000000000000000000000000000000087654321;

        (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x0000000000000000000000000000000000000000000000000000000000000001,
              0x0000000000000000000000000000000000000000000000000000000000000000);

        require(
             (x == 0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 1');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x0000000000000000000000000000000000000000000000000000000087654321,
              0x0000000000000000000000000000000000000000000000000000000000000000);
        require(
             (x == 0x0000000000000125bb0144149e4753e79ca098893db2c00a9500063b3b703cc1) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 2');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x000000000000000000000000000000000000000000000000479bf4dad7a44a41,
              0x0000000000000000000000000000000000000000000000000000000000000000);
        require(
             (x == 0x0000009b59cd78352b953b785020eaa5c64e2fa2150d52a7e858f182c88357e1) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000000), 'fails at 3');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x000000000000000000000000000000000000000025df916e0e3e8d9f5e419561,
              0x0000000000000000000000000000000000000000000000000000000000000000);
        require(
             (x == 0x29ce84fbd0e84d7f95862034f0a21a3c4a97e43f5b1f2be77b02bb7f8bb33701) &&
             (y == 0x0000000000000000000000000000000000000000000000000000000000000052), 'fails at 4');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x000000000000000000000000000000001407e0d3ced028471fb5bcdc66d1a481,
              0x0000000000000000000000000000000000000000000000000000000000000000);
        require(
             (x == 0xb2f0f8a7956a1a7b00806d9796e2b095d45d64774bb436fcce6a2cb723e45a21) &&
             (y == 0x0000000000000000000000000000000000000000000000000000002b748bf223), 'fails at 5');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x0000000000000000000000000a9813ec0a7bc7cb892827c3640825c80cf8f7a1,
              0x0000000000000000000000000000000000000000000000000000000000000000);
        require(
             (x == 0x9c0cd08857668772da9cdf96758a02b85d521349ef36ae149d92469f5a0b4141) &&
             (y == 0x000000000000000000000000000000000000000000000016fba62d0201dc3aa1), 'fails at 6');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x0000000000000000059a63488078c15de7e04ff1ea6c06816db4a2fe6e6c0ec1,
              0x0000000000000000000000000000000000000000000000000000000000000000);
        require(
             (x == 0xa41c1d541b437ed1cb155a0a9173b3be1bf20c82b2d623d97db144f5932c6c61) &&
             (y == 0x000000000000000000000000000000000000000c27cbf11ebef9328d3bc92db2), 'fails at 7');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x0000000002f6a1bc883d2394f9804672b5e712964f8b409de58e261c1cef69e1,
              0x0000000000000000000000000000000000000000000000000000000000000000);
        require(
             (x == 0xb6808ec3eb0205ff782cf0407d26050643054d5d4b679d4d88a4a6da82715b6c) &&
             (y == 0x00000000000000000000000000000000078806f4b2c222f2c6cbe278084aae87), 'fails at 8');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x01913b5f29592ed8298aa8430527b95c85e68d3575362e9ca7a5f07cd0578901,
              0x0000000000000000000000000000000000000000000000000000000000000000);
        require(
             (x == 0xd1979e9b3412050795ba667cb98e3662896c665c9d3d65f1f0e5fd4fa9bf2c96) &&
             (y == 0x0000000000000000000000000000000004b8c83fa1c6195d82e49a1aa60ea2ba), 'fails at 9');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0xd19be6fa24f21f2c5f123668fbbf8465809402864a65a85bbd7106665888ec21,
              0x0000000000000000000000000000000000000000000000000000000000d43504);
        require(
             (x == 0x975190b7c1b3d2d01967187439c5cc71158cbd59c59ed477193f51d37dc016e2) &&
             (y == 0x00000000000000000000000000000000002d1bf03f3ba3763a6c8d8684c60a84), 'fails at 10');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0xdcb87fe0d402be7ad9c3cecc563069761ff46eabff430e5f7f4fbee7cf781341,
              0x00000000000000000000000000000000000000000000000000703be61aab01ca);
        require(
             (x == 0x4719b65d4242ef35f556dcd16c90eed920e7ad0db54222d751cccf54fac3cefa) &&
             (y == 0x000000000000000000000000000000000d1fcdaef1f5c2413a1f15cddc26220f), 'fails at 11');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0xc0c16afffb82e122a96eab9cae4c046374f15a037c3820c3d81b73b50b297e61,
              0x0000000000000000000000000000000000000000003b5bfb67fda50de0f1b324);
        require(
             (x == 0x2750d4792b0a409d8c1912b29c499793619fa9bc5346c02a50133fc31f7af703) &&
             (y == 0x00000000000000000000000000000000080c30a87a4c9ea34a171578106e28d5), 'fails at 12');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0xac90092ec6d14cf922e8fb1e8adb021d978d1f61e80a37a72a2295464fb1ad81,
              0x00000000000000000000000000000000001f64fc6ec070bc39fe1d7d5030c1eb);
        require(
             (x == 0xcd745dd9a178b7ad720d73e3c09e6e51d1c78e035802d9b1282a9b21ceda5f95) &&
             (y == 0x00000000000000000000000000000000159af635e386455b738d9ea277cb061b), 'fails at 13');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x3b453d3b27d3c298a807a3cca8613ab47b659abab20dc8f0744ac884413520a1,
              0x00000000000000000000000000109aac317942e66127ae3fb333f2a3e304b736);
        require(
             (x == 0x0082026b5b0abcb0ff969fca9e3cf70d698757b85e55a0820961c28d4768a8eb) &&
             (y == 0x0000000000000000000000000000000016d9f0e230f7ed1eab2752cc59e4b15b), 'fails at 14');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0x1d4ac236d5105c0c356461c47d2d113dff255311a38f26ad6aaf344815e857c1,
              0x00000000000000000008c8222ea57843ff442cab3f5a3a8fd99339046135b51c);
        require(
             (x == 0x2fcba4b950f3c6c99f6999740a776ba6650715494b3d05172db892edf15b58b1) &&
             (y == 0x0000000000000000000000000000000011e50e8fea4bd8e59f8323062b767522), 'fails at 15');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0xe17512d3802c0fb5580f2df66d54cb4cbbc357f44240daf83f42c5f8080fd2e1,
              0x000000000004a50349986851a03ef606ad732722be72aca361e42bb3dddcaf33);
        require(
             (x == 0xf3aaf943e1e1b48e822797b1d6d7390ca585f2b4b14a85a3216bbab4ef6f627a) &&
             (y == 0x000000000000000000000000000000001767d51aeaed9a0f35750d6eb55e1234), 'fails at 16');

          (x,y) = field3.mulmod_p381(
              0x00000000000000000000022b5f6df4dfa0c8a0e35eb9cb284d233c383da565a1,
              0x0000000000000000000000000000000000000000000000000000000000000000,
              0xaa0d9579e1c63ba668dd450af56d617bd6819ae2d0f85e4c8886f58808001201,
              0x000274db0de489d393a83c0ab89b9e534239bf9ad50bf5bf6dcf9db5d6a9d9cf);
        require(
             (x == 0xc88992d202827106967936e1916e7e415e22cb44eda3fb3988f6c87c3d29c38a) &&
             (y == 0x000000000000000000000000000000000b53eb88fb2dd4dc0a424c007c5ba394), 'fails at 17');}

}
